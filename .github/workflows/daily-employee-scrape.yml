name: Daily employee scrape

on:
  schedule:
    # Runs every day at 23:00 UTC (11 PM UTC)
    - cron: "0 23 * * *"

  # Allows manual runs from GitHub UI
  workflow_dispatch:
    inputs:
      reason:
        description: "Why are you running this manually?"
        required: false
        default: "Manual debug run"

jobs:
  trigger-scrape:
    runs-on: ubuntu-latest

    steps:
      - name: Log trigger info
        run: |
          echo "Triggered at: $(date -u)"
          echo "Trigger reason: ${{ github.event.inputs.reason }}"
          echo "Triggered by: ${{ github.actor }}"
          echo "Event type: ${{ github.event_name }}"

      - name: Trigger Render scrape endpoint
        run: |
          curl -v \
            --max-time 30 \
            "https://ppm-scripts-fs.onrender.com/api/v1/employees"

      - name: Done
        run: echo "Scrape trigger completed"
